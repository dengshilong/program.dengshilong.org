title: 再次测试某yd验证码
date: 2023-12-28 16:24:00
tags:
    - 逆向
    - JavaScript
    - 补环境
    - 扣代码
    - 验证码
categories:
---
之前用补环境框架测试过某yd验证码，虽然能过，但存在一点不足，那就是速度太慢了，生成一次参数将近1秒，时间都花在创建沙盒环境和执行无效代码了。这么慢的速度，放在生成环境的话，得需要花费很多CPU资源，于是得想想其它的方案。

最先想到的是扣代码，把参数加密相关的函数缺啥补啥的一个一个拿出来，在使用补环境之前试过这个方法，麻烦是麻烦一些，但总能解决。后来和时光佬提起这个事情，他在[时光漫漫星球](https://articles.zsxq.com/id_u1ec69cdbc51.html)里写过相关的文章，可以去参考下。在时光佬的帮助下，很快就搞定cb, fp, 轨迹加密等参数，很快就跑起来了。测试了下速度，能做到100ms生成一次参数，是之前补环境的10倍，这速度满足需求了。

奇葩的是，每小时的0到20分钟过不了校验接口，而每小时的20到60分钟就能过去，但浏览器上是任何时候都能过，于是怀疑是b和d接口没请求。于是参考十一姐写的[相关文章](https://mp.weixin.qq.com/s/tVBNYlQg34GxNzE3RPI57w)，把b和d接口加上。不得不说，十一姐写的文章是真的详细，主打一个手把手教程。神奇的是，把b和d接口加上后，还是过不去，这就很离谱了，百思不得其解。后来问了道上的朋友，他们也有类似的遭遇，一直解决不了，既然大家都一样，那就暂时先放一放了。

补环境虽然解决的快，但生成参数的速度真的是太慢了，以后得慎重使用。
