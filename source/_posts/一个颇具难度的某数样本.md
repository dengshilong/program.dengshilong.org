title: 一个颇具难度的某数样本
date: 2025-05-13 20:37:59
tags:
    - 爬虫
    - 补环境
    - 逆向
    - rs
categories:
---
一个月前有道友反馈，过不去aHR0cHM6Ly93d3cuY2Vid20uY29tL3dlYWx0aC9qZ2xjMzkvaW5kZXguaHRtbCA=这个样本获取token的接口，于是掏出祖传补环境代码去测试，首页能过，接口竟然过不去，于是把所有的备用方案拿去测试，竟然都过不去，我惊了，这是难得一见的补环境过不去的网站了。

此时只好拿出算法方案，意外发现以前用的找20取4位数组的方法竟然失效了。于是拿出尘封已久的AST代码，也没办法还原控制流混淆了，估计是控制流混淆有点变化。于是索性不还原，直接在vmp循环里打日志慢慢调试，搞了一天，愣是没搞定。

于是求助小黄鱼大佬们，问了一圈补环境方案，竟然没找到一个能搞定的，看来大家的补环境水平都差不多了。于是求助算法大佬们，终于找到解决的办法。其实算法没变化，只是我用的20取4位数组的办法还不够通用，在这个站点上正好失效了。

有了算法方案后，对比之后发现这个站点上之所以过不去是因为校验指纹数组了，于是想起2年前曾研究过这个指纹数组，找到2年前的补环境，发现竟然能过，收工。

头疼的是，第二天补环境就要跑不动了，测试通过率只有60%，算法方案才能稳稳的跑通。结果前几天，补环境和算法方案都跑不动了，仔细一看，url加密，表单加密，响应加密都上了，这属实是全家桶了，头皮发麻。
